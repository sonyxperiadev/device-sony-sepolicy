allow vold persist_file:dir r_dir_perms;

allow vold proc_swaps:file r_file_perms;
allow vold {
      system_block_device
      adsprpcd_block_device
      persist_block_device
}:blk_file getattr;

# Vold would have access to /sys/block/mmcblk0 because it can
# access all of u:r:sysfs:s0. But since we have labeled the
# mmc nodes differently, vold needs access to the new labels:
allow vold sysfs_mmc:file w_file_perms;

# Load crypto modules
allow vold kernel:system module_request;

# generated by proc scan, unnecessary
dontaudit vold proc_irq:dir { read open };
